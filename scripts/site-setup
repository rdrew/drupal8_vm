#
# My first shell script
#

#Get the  project name
echo "Directory name of the remote site:"
read siteName

#Insert the namein some relavent locations
grep -rl remotesitename ./drush | xargs sed -i '' -e "s/remotesitename/$siteName/"
grep -rl remotesitename ./vm | xargs sed -i '' -e "s/remotesitename/$siteName/"

#set up clean codebase 
composer install

#set up vm and db
vagrant up

#pull down the remote codebase without the db configs
rsync -avz --dry-run --progress --exclude-from 'vm/rsync_config.txt' rdrew@137.149.200.22:/var/www/html/$siteName/ .

#rerun composer to get remote dependancies
composer install

#make sure the vm is included
composer require --dev geerlingguy/drupal-vm

#drush sql-sync @remote @local
#drush updb @local
#drush cr @local
